# Semantic-Segmentation

> **TH/EN README** ‚Äî ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå Semantic Segmentation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å **Roboflow** ‡πÅ‡∏•‡∏∞‡∏ù‡∏∂‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏• ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå **Gradio** ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏±‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏î‡πÇ‡∏°‡πà‡πÅ‡∏ö‡∏ö‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ

---

## üì¶ Repository Overview

- `main.py` ‚Äî ‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å: ‡πÇ‡∏´‡∏•‡∏î **dataset** ‡∏à‡∏≤‡∏Å Roboflow ‡∏ï‡∏≤‡∏°‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡πÉ‡∏ô `.env` ‡πÅ‡∏•‡∏∞ **train** ‡πÇ‡∏°‡πÄ‡∏î‡∏•
- `Gradio/`
  - `_classes.csv` ‚Äî ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏≤‡∏™ (‡∏•‡∏≥‡∏î‡∏±‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏°‡πÄ‡∏î‡∏•)
  - `app_semseg.py` ‚Äî ‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏≠‡∏õ Gradio ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö inference/‡πÄ‡∏î‡πÇ‡∏°‡πà
  - `best_lraspp_mbv3.pth` ‚Äî ‡πÑ‡∏ü‡∏•‡πå **weights** ‡∏Ç‡∏≠‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏• (LRASPP + MobileNetV3 Large)
- `.env` ‚Äî ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ Roboflow ‡πÅ‡∏•‡∏∞‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏ó‡∏£‡∏ô‡∏ï‡πà‡∏≤‡∏á ‡πÜ (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á)

‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°:
```
Semantic-Segmentation/
‚îú‚îÄ main.py
‚îú‚îÄ .env
‚îî‚îÄ Gradio/
   ‚îú‚îÄ _classes.csv
   ‚îú‚îÄ app_semseg.py
   ‚îî‚îÄ best_lraspp_mbv3.pth
```

---

## ‚úÖ Requirements / ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ

‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡πÇ‡∏•‡∏Ñ‡∏±‡∏•‡πÅ‡∏•‡∏∞ Google Colab):
```bash
pip install -q torch torchvision roboflow python-dotenv tqdm gradio pillow opencv-python
```

> ‡∏´‡∏≤‡∏Å‡πÉ‡∏ä‡πâ CUDA ‡πÉ‡∏´‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á PyTorch ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡∏£‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á: https://pytorch.org/get-started/locally/

---

## üîß Environment (.env)

‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `.env` ‡∏ó‡∏µ‡πà root ‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á):
```env
# --- Roboflow ---
RF_API_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
RF_WORKSPACE=hoi-rmqtp
RF_PROJECT=human-object-interaction-pcpk1
RF_VERSION=2

# --- Training config (‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ) ---
IMGSZ=640
BATCH=8
EPOCHS=20
LR=0.0003
ACCUM=4
AMP=1
PRELOAD=1
FREEZE_BACKBONE_EPOCHS=1
NUM_WORKERS=2

# ‡πÇ‡∏°‡πÄ‡∏î‡∏• backbone/‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á)
MODEL=deeplabv3_resnet50
COMPILE=0
USE_TQDM=1

# Logging
LOG_EVERY=10
LOG_FILE=runs/semseg/train_log.csv
```

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏**
- ‡∏ñ‡πâ‡∏≤ dataset ‡πÄ‡∏õ‡πá‡∏ô **Semantic Segmentation** ‡πÉ‡∏´‡πâ‡∏°‡∏±‡πà‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤ pipeline/‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÉ‡∏ô `main.py` map ‡∏Å‡∏±‡∏ö‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö mask ‡πÅ‡∏•‡∏∞‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏•‡∏≤‡∏™‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- ‡∏Ñ‡πà‡∏≤ `RF_*` ‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î dataset ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å Roboflow

---

## üöÄ Quick Start

### 1) Train
‡∏£‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏Å‡∏±‡∏ö `main.py`
```bash
python main.py
```
‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏à‡∏∞:
1. ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤ config ‡∏à‡∏≤‡∏Å `.env`
2. ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î dataset ‡∏à‡∏≤‡∏Å Roboflow
3. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏ó‡∏£‡∏ô‡πÇ‡∏°‡πÄ‡∏î‡∏• ‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å log + checkpoints

> ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå (weights/logs) ‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô `runs/` (‡∏´‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏ô `LOG_FILE`/‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå)

### 2) Inference Demo (Gradio)
‡πÄ‡∏Ç‡πâ‡∏≤‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `Gradio/` ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏±‡∏ô:
```bash
cd Gradio
python app_semseg.py
```
‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏ã‡∏• (‡πÄ‡∏ä‡πà‡∏ô `http://127.0.0.1:7860`) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏î‡πÇ‡∏°‡πà

**‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ**
- `Gradio/best_lraspp_mbv3.pth` ‚Äî ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÇ‡∏°‡πÄ‡∏î‡∏•
- `Gradio/_classes.csv` ‚Äî ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏≤‡∏™ (‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏Ñ‡∏•‡∏≤‡∏™‡∏ï‡πà‡∏≠‡∏´‡∏ô‡∏∂‡πà‡∏á‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î, index ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö training)

---

## üß† Tips (Colab / T4 Friendly)

- ‡∏ñ‡πâ‡∏≤‡πÄ‡∏à‡∏≠ **CUDA OOM** (‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡πÑ‡∏°‡πà‡∏û‡∏≠)
  - ‡∏•‡∏î `BATCH`, ‡∏•‡∏î `IMGSZ` (‡πÄ‡∏ä‡πà‡∏ô 512/480), ‡πÄ‡∏û‡∏¥‡πà‡∏° `ACCUM` (gradient accumulation)
  - ‡πÄ‡∏õ‡∏¥‡∏î `AMP=1` (Automatic Mixed Precision)
  - ‡∏•‡∏î `NUM_WORKERS` ‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏¥‡∏î `PRELOAD`
- ‡πÄ‡∏ó‡∏£‡∏ô‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô:
  - ‡πÉ‡∏ä‡πâ `PRELOAD=1` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏∏‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏•‡πá‡∏Å (‡πÅ‡∏ï‡πà‡∏≠‡∏≤‡∏à‡πÉ‡∏ä‡πâ RAM ‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô)
  - ‡∏õ‡∏£‡∏±‡∏ö `FREEZE_BACKBONE_EPOCHS` > 0 ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Warm‚Äëup
- ‡∏ñ‡πâ‡∏≤ RAM ‡∏™‡∏π‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ ‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡∏∞‡∏™‡∏° tensor ‡πÉ‡∏ô‡∏•‡∏π‡∏õ‡πÄ‡∏ó‡∏£‡∏ô (ensure `optimizer.zero_grad(set_to_none=True)` ‡πÅ‡∏•‡∏∞ `with torch.no_grad()` ‡∏ó‡∏µ‡πà inference)

---

## üìö How it works (high‚Äëlevel)

- **`main.py`** ‡∏≠‡πà‡∏≤‡∏ô‡∏Ñ‡πà‡∏≤ config ‡∏à‡∏≤‡∏Å `.env` ‚Üí ‡∏î‡∏∂‡∏á dataset ‡∏ú‡πà‡∏≤‡∏ô Roboflow API ‚Üí ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° DataLoader ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏°‡πÄ‡∏î‡∏• (‡πÄ‡∏ä‡πà‡∏ô `LRASPP MobileNetV3` / `DeepLabV3‚ÄëResNet50`) ‚Üí ‡πÄ‡∏ó‡∏£‡∏ô‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å weights
- **`Gradio/app_semseg.py`** ‡πÇ‡∏´‡∏•‡∏î weights (`best_lraspp_mbv3.pth`) ‡πÅ‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡∏Ñ‡∏•‡∏≤‡∏™ ‚Üí ‡πÉ‡∏´‡πâ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏†‡∏≤‡∏û/‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• segmentation ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô

---

## üóÇÔ∏è Dataset (Roboflow)

- ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå Roboflow ‡πÅ‡∏•‡∏∞‡πÇ‡∏Ñ‡∏ß‡∏ï‡∏≤‡∏Å‡∏≤‡∏£‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
- ‡∏´‡∏≤‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô dataset ‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà `.env` (`RF_WORKSPACE`, `RF_PROJECT`, `RF_VERSION`)

---

## üß™ Reproducibility

- ‡∏£‡∏∞‡∏ö‡∏∏ seed/‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡πÉ‡∏ô issue ‡∏´‡∏£‡∏∑‡∏≠ PR ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏Å‡∏±‡∏ô‡∏î‡∏µ‡∏ö‡∏±‡∏Å
- ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏™‡πà‡πÑ‡∏ü‡∏•‡πå `requirements.txt` (‡∏≠‡∏≠‡∏õ‡∏ä‡∏±‡∏ô) ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ lock ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á `requirements.txt` ‡πÅ‡∏ö‡∏ö‡∏´‡∏•‡∏ß‡∏°:
```
torch
torchvision
roboflow
python-dotenv
tqdm
gradio
pillow
opencv-python
```

---

## ü§ù Contributing

‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏£‡∏±‡∏ö PR/Issue:
- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏´‡∏°‡πà
- ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏ö‡∏ô Colab/T4
- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏¢‡∏π‡∏ó‡∏¥‡∏•‡∏¥‡∏ï‡∏µ‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö evaluation (mIoU, Pixel Acc, Confusion Matrix)

---

## üìÑ License

‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏•‡πÄ‡∏ã‡∏ô‡∏™‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡πÄ‡∏ä‡πà‡∏ô MIT, Apache‚Äë2.0) ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `LICENSE` ‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå

---

## ‚ú® Acknowledgements

- [Roboflow](https://roboflow.com/) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö dataset pipeline
- PyTorch / TorchVision
- Gradio ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö UI ‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏á‡πà‡∏≤‡∏¢

---

> ‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ README ‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏•‡πâ‡∏ß‡∏ô ‡πÜ ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏° badge/‡∏†‡∏≤‡∏û‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á/‡∏ú‡∏•‡πÄ‡∏ó‡∏£‡∏ô ‡∏ö‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö
